name: Ejecutar pruebas

on:
  push:
    branches:
      - master

jobs:
  test:
    runs-on: windows-latest

    steps:
      - name: Clonar repositorio
        uses: actions/checkout@v3

      - name: Instalar .NET
        uses: actions/setup-dotnet@v3
        with:
          dotnet-version: '8.0.x'  # ajusta según tu versión

      - name: Restaurar dependencias
        run: dotnet restore # Recomendado manejarlo para evitar el error "NETSDK1064: Package xunit.analyzers, version 1.4.0 was not found."

      - name: Compilar solución
        run: dotnet build --no-restore # Recomendado manejarlo asi para la restauracion ya que "--no-restore" omite la restauracion

      - name: Ejecutar pruebas
        id: Test xUnit
        run: dotnet test Domain.Test/Domain.Test.csproj --no-build --verbosity normal

      - name: Mensaje si pruebas pasan
        if: success()
        run: echo "Las pruebas fueron exitosas."

      - name: Mensaje si pruebas fallan
        if: failure()
        run: echo "Las pruebas fallaron. Revisa los errores antes de continuar."